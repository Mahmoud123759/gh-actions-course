name: 16 - Working with Environments
on:
    workflow_dispatch:
      
jobs:
    deploy-staging:
        runs-on: ubuntu-latest
        environment: staging

        steps: 
            - name: Echo vars
              run: |
                echo "deploying to staging"
    e2e-test:
        runs-on: ubuntu-latest
        needs: deploy-staging
        steps:
            - name: E2E tests
              run: echo "running e2e"
    deploy-prod-frontend:

        runs-on: ubuntu-latest
        needs: e2e-test
        environment: production

        steps: 
            - name: Echo vars
              run: |
                echo "deploying to prod frontend"
    deploy-prod-backend1:
        runs-on: ubuntu-latest
        needs: e2e-test

        environment: production
        steps: 
            - name: Echo vars
              run: |
                echo "deploying to prod backend1"
    deploy-prod-backend2:
        runs-on: ubuntu-latest
        needs: e2e-test

        environment: production
        steps: 
            - name: Echo vars
              run: |
                echo "deploying to prod backend2"
                                                            